covert to excel local.py


import pandas as pd
import xlsxwriter
import os
import glob
import sys
import boto3
import shutil
from datetime import datetime,timedelta,date

ar_lst = list(sys.argv)
list_env = ar_lst[1]

today = date.today().strftime("%d-%m-%Y")

CI_PROJECT_DIR = os.environ.get("CI_PROJECT_DIR")
source_dir = f"{CI_PROJECT_DIR}/artifacts"
target_dir = f"{CI_PROJECT_DIR}/final-artifact"

os.makedirs(target_dir, exist_ok=True)

for env_name in list_env.split(','):
    print(env_name)
    workbook_name = f"{target_dir}/{env_name.lower()}_audit_reports_{today}.xlsx"
    print(workbook_name)
    workbook = pd.ExcelWriter(workbook_name, engine='xlsxwriter')
    #csv_dir = f"{source_dir}/{env_name.lower()}-audit-reports"
    for csv_file in glob.glob(os.path.join(source_dir, "*.csv")):
        print(csv_file)
        dataframe = pd.read_csv(csv_file)
        dataframe.to_excel(workbook, sheet_name=os.path.basename(csv_file)[:-4])  
    workbook.save()

print(f"All CSV files in {source_dir} have been converted to Excel files and saved in {target_dir}.")

please update the code
